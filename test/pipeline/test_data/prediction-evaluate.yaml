apiVersion: core/v1beta1
metadata:
  name: forcast
  provider: 1557702098194904
  identifier: prediction-evaluate
  version: v1
spec:
  pipelines:
    - metadata:
        name: prediction1
        provider: 1557702098194904
        identifier: prediction-xflow-ODPS
        version: v1
      spec:
        arguments:
          artifacts:
            - name: inputModelArtifact
              from: '{{inputs.artifacts.inputModelArtifact}}'
            - name: inputDataSetArtifact
              from: '{{inputs.artifacts.inputDataSetArtifact}}'
          parameters:
            - name: __execution
              from: '{{inputs.parameters.__execution}}'
            - name: outputTableName
              from: '{{inputs.parameters.outputTableName}}'
            - name: featureColNames
              value: pm10,so2,co,no2
            - name: appendColNames
              value: time,hour,_c2,pm10,so2,co,no2
            - name: resultColName
              value: prediction_result
            - name: scoreColName
              value: prediction_score
            - name: detailColName
              value: prediction_detail
    - metadata:
        name: evaluate1
        provider: 1557702098194904
        identifier: evaluate-xflow-ODPS
        version: v1
      spec:
        arguments:
          artifacts:
            - name: inputArtifact
              from: '{{pipelines.prediction1.outputs.artifacts.outputArtifact}}'
          parameters:
            - name: __execution
              from: '{{inputs.parameters.__execution}}'
            - name: outputDetailTableName
              from: '{{inputs.parameters.outputDetailTableName}}'
            - name: outputMetricTableName
              from: '{{inputs.parameters.outputMetricTableName}}'
            - name: outputELDetailTableName
              from: '{{inputs.parameters.outputELDetailTableName}}'
            - name: labelColName
              value: _c2
            - name: scoreColName
              value: prediction_score
            - name: positiveLabel
              value: 1
            - name: binCount
              value: 1000
        dependencies:
          - prediction1
    - metadata:
        name: evaluate2
        provider: 1557702098194904
        identifier: evaluate-xflow-ODPS
        version: v1
      spec:
        arguments:
          artifacts:
            - name: inputArtifact
              from: '{{pipelines.prediction1.outputs.artifacts.outputArtifact}}'
          parameters:
            - name: __execution
              from: '{{inputs.parameters.__execution}}'
            - name: outputELDetailTableName
              from: '{{inputs.parameters.outputELDetailTableName2}}'
            - name: outputDetailTableName
              from: '{{inputs.parameters.outputDetailTableName2}}'
            - name: outputMetricTableName
              from: '{{inputs.parameters.outputMetricTableName2}}'
            - name: labelColName
              value: _c2
            - name: scoreColName
              value: prediction_score
            - name: positiveLabel
              value: 1
            - name: binCount
              value: 1000
        dependencies:
          - prediction1
  outputs:
    artifacts:
      - name: predictionResult
        from: '{{pipelines.prediction1.outputs.artifacts.outputArtifact}}'
  inputs:
    parameters:
      - name: __execution
        type: Map
      - name: outputTableName
        type: String
        required: true
      - name: outputDetailTableName
        type: String
        required: true
      - name: outputMetricTableName
        type: String
        required: true
      - name: outputDetailTableName2
        type: String
        required: true
      - name: outputMetricTableName2
        type: String
        required: true
      - name: outputELDetailTableName
        type: String
        required: true
      - name: outputELDetailTableName2
        type: String
        required: true
    artifacts:
      - name: inputModelArtifact
        type: {Model: {locationType: MaxComputeVolume, modelType: OfflineModel}}
        required: true
      - name: inputDataSetArtifact
        type: {DataSet: {locationType: MaxComputeTable}}
        required: true